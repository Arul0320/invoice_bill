{% extends 'billing/base.html' %}
{% block title %}Create Invoice{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Create Invoice</h1>

<form method="POST" class="space-y-4">
    {% csrf_token %}
    <label class="block">
        Select Customer:
        <select name="customer" class="border p-2 w-full">
            {% for c in customers %}
            <option value="{{ c.id }}">{{ c.name }}</option>
            {% endfor %}
        </select>
    </label>

    <h2 class="text-xl font-semibold mt-4">Products</h2>
    <div id="product-list">
        <div class="flex space-x-2 mb-2">
            <select name="product" class="border p-2 w-1/2">
                {% for p in products %}
                <option value="{{ p.id }}">{{ p.name }} - ₹{{ p.price }}</option>
                {% endfor %}
            </select>
            <input type="number" name="qty" value="1" min="1" class="border p-2 w-1/4" />
        </div>
    </div>

    <button type="button" onclick="addProductRow()" class="bg-gray-600 text-white px-3 py-1 rounded">+ Add Another Product</button>

    <br><br>
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Save Invoice</button>
</form>

<script>
function addProductRow() {
    let div = document.createElement("div");
    div.classList.add("flex", "space-x-2", "mb-2");
    div.innerHTML = `
        <select name="product" class="border p-2 w-1/2">
            {% for p in products %}
            <option value="{{ p.id }}">{{ p.name }} - ₹{{ p.price }}</option>
            {% endfor %}
        </select>
        <input type="number" name="qty" value="1" min="1" class="border p-2 w-1/4" />
    `;
    document.getElementById("product-list").appendChild(div);
}
</script>
{% endblock %}
